---
import Navbar from "../components/Navbar.astro";
---

<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>Login</title>
    </head>
    <body>
        <Navbar />
        <h2>Login to your Spotify account</h2>
        <button id="spotifyLoginButton">Login with Spotify</button>

        <script>
            const spotifyLoginButton = document.querySelector(
                "#spotifyLoginButton",
            ) as HTMLButtonElement;

            spotifyLoginButton.addEventListener("click", async () => {
                try {
                    // window.location.href = "http://localhost:3000/login";

                    const response = await fetch(
                        "http://localhost:3000/login",
                        {
                            method: "POST",
                            headers: {
                                "Content-Type": "application/json",
                            },
                            credentials: "include",
                        },
                    );

                    if (response.ok) {
                        alert("Login Route successful!");
                    } else {
                        alert("Login failed");
                    }
                } catch (error) {
                    console.error("Error during login:", error);
                }
            });
        </script>
    </body>
</html>
